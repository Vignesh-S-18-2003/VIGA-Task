{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vignesh\\\\Desktop\\\\Pep\\\\VIGA Task\\\\VIGA-Task\\\\client\\\\src\\\\components\\\\Main.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { fetchBooks, fetchReviews, addReview, deleteReview } from \"../api\";\nimport { useNavigate } from \"react-router\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Main() {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [reviews, setReviews] = useState({});\n  const [newComment, setNewComment] = useState(\"\");\n  const navigate = useNavigate();\n  useEffect(() => {\n    const getBooksAndReviews = async () => {\n      const {\n        data: booksData\n      } = await fetchBooks();\n      setBooks(booksData);\n      const reviewsData = {};\n      for (const book of booksData) {\n        const {\n          data: bookReviews\n        } = await fetchReviews(book._id);\n        reviewsData[book._id] = bookReviews;\n      }\n      setReviews(reviewsData);\n    };\n    getBooksAndReviews();\n  }, []);\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"username\");\n    navigate(\"/login\");\n  };\n  const handleAddReview = async bookId => {\n    const token = localStorage.getItem(\"token\");\n    const config = {\n      headers: {\n        Authorization: token\n      }\n    };\n    try {\n      await addReview({\n        bookId,\n        comment: newComment\n      }, config);\n      alert(\"Review added!\");\n      setNewComment(\"\");\n      window.location.reload();\n    } catch (err) {\n      alert(\"Error adding review\");\n    }\n  };\n  const handleDeleteReview = async reviewId => {\n    const token = localStorage.getItem(\"token\");\n    const config = {\n      headers: {\n        Authorization: token\n      }\n    };\n    try {\n      await deleteReview(reviewId, config);\n      alert(\"Review deleted!\");\n      window.location.reload();\n    } catch (err) {\n      alert(\"Error deleting review\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleLogout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Book List\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), books.map(book => {\n      var _reviews$book$_id;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: book.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Author: \", book.author]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Reviews:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), (_reviews$book$_id = reviews[book._id]) === null || _reviews$book$_id === void 0 ? void 0 : _reviews$book$_id.map(rev => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [rev.reviewer, \": \", rev.comment]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 15\n          }, this), rev.reviewer === localStorage.getItem(\"username\") && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleDeleteReview(rev._id),\n            children: \"Delete Review\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 17\n          }, this)]\n        }, rev._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Add a review\",\n          value: newComment,\n          onChange: e => setNewComment(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleAddReview(book._id),\n          children: \"Add Review\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this)]\n      }, book._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(Main, \"NAJ4YRg5Mt8XNBM9zbHD1P1T/Io=\", false, function () {\n  return [useNavigate];\n});\n_c = Main;\nexport default Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["React","useEffect","useState","fetchBooks","fetchReviews","addReview","deleteReview","useNavigate","jsxDEV","_jsxDEV","Main","_s","books","setBooks","reviews","setReviews","newComment","setNewComment","navigate","getBooksAndReviews","data","booksData","reviewsData","book","bookReviews","_id","handleLogout","localStorage","removeItem","handleAddReview","bookId","token","getItem","config","headers","Authorization","comment","alert","window","location","reload","err","handleDeleteReview","reviewId","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","map","_reviews$book$_id","title","author","rev","reviewer","type","placeholder","value","onChange","e","target","_c","$RefreshReg$"],"sources":["C:/Users/vignesh/Desktop/Pep/VIGA Task/VIGA-Task/client/src/components/Main.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { fetchBooks, fetchReviews, addReview, deleteReview } from \"../api\";\r\nimport { useNavigate } from \"react-router\";\r\n\r\nfunction Main() {\r\n  const [books, setBooks] = useState([]);\r\n  const [reviews, setReviews] = useState({});\r\n  const [newComment, setNewComment] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const getBooksAndReviews = async () => {\r\n      const { data: booksData } = await fetchBooks();\r\n      setBooks(booksData);\r\n\r\n      const reviewsData = {};\r\n      for (const book of booksData) {\r\n        const { data: bookReviews } = await fetchReviews(book._id);\r\n        reviewsData[book._id] = bookReviews;\r\n      }\r\n      setReviews(reviewsData);\r\n    };\r\n    getBooksAndReviews();\r\n  }, []);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"username\");\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const handleAddReview = async (bookId) => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const config = { headers: { Authorization: token } };\r\n\r\n    try {\r\n      await addReview({ bookId, comment: newComment }, config);\r\n      alert(\"Review added!\");\r\n      setNewComment(\"\");\r\n      window.location.reload();\r\n    } catch (err) {\r\n      alert(\"Error adding review\");\r\n    }\r\n  };\r\n\r\n  const handleDeleteReview = async (reviewId) => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const config = { headers: { Authorization: token } };\r\n\r\n    try {\r\n      await deleteReview(reviewId, config);\r\n      alert(\"Review deleted!\");\r\n      window.location.reload();\r\n    } catch (err) {\r\n      alert(\"Error deleting review\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button onClick={handleLogout}>Logout</button>\r\n      <h2>Book List</h2>\r\n      {books.map((book) => (\r\n        <div key={book._id}>\r\n          <h3>{book.title}</h3>\r\n          <p>Author: {book.author}</p>\r\n          <h4>Reviews:</h4>\r\n          {reviews[book._id]?.map((rev) => (\r\n            <div key={rev._id}>\r\n              <p>\r\n                {rev.reviewer}: {rev.comment}\r\n              </p>\r\n              {rev.reviewer === localStorage.getItem(\"username\") && (\r\n                <button onClick={() => handleDeleteReview(rev._id)}>\r\n                  Delete Review\r\n                </button>\r\n              )}\r\n            </div>\r\n          ))}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Add a review\"\r\n            value={newComment}\r\n            onChange={(e) => setNewComment(e.target.value)}\r\n          />\r\n          <button onClick={() => handleAddReview(book._id)}>Add Review</button>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Main;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,UAAU,EAAEC,YAAY,EAAEC,SAAS,EAAEC,YAAY,QAAQ,QAAQ;AAC1E,SAASC,WAAW,QAAQ,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3C,SAASC,IAAIA,CAAA,EAAG;EAAAC,EAAA;EACd,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACY,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC1C,MAAM,CAACc,UAAU,EAAEC,aAAa,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAMgB,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAE9BN,SAAS,CAAC,MAAM;IACd,MAAMkB,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,MAAM;QAAEC,IAAI,EAAEC;MAAU,CAAC,GAAG,MAAMlB,UAAU,CAAC,CAAC;MAC9CU,QAAQ,CAACQ,SAAS,CAAC;MAEnB,MAAMC,WAAW,GAAG,CAAC,CAAC;MACtB,KAAK,MAAMC,IAAI,IAAIF,SAAS,EAAE;QAC5B,MAAM;UAAED,IAAI,EAAEI;QAAY,CAAC,GAAG,MAAMpB,YAAY,CAACmB,IAAI,CAACE,GAAG,CAAC;QAC1DH,WAAW,CAACC,IAAI,CAACE,GAAG,CAAC,GAAGD,WAAW;MACrC;MACAT,UAAU,CAACO,WAAW,CAAC;IACzB,CAAC;IACDH,kBAAkB,CAAC,CAAC;EACtB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMO,YAAY,GAAGA,CAAA,KAAM;IACzBC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;IAChCD,YAAY,CAACC,UAAU,CAAC,UAAU,CAAC;IACnCV,QAAQ,CAAC,QAAQ,CAAC;EACpB,CAAC;EAED,MAAMW,eAAe,GAAG,MAAOC,MAAM,IAAK;IACxC,MAAMC,KAAK,GAAGJ,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,MAAM,GAAG;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAEJ;MAAM;IAAE,CAAC;IAEpD,IAAI;MACF,MAAM1B,SAAS,CAAC;QAAEyB,MAAM;QAAEM,OAAO,EAAEpB;MAAW,CAAC,EAAEiB,MAAM,CAAC;MACxDI,KAAK,CAAC,eAAe,CAAC;MACtBpB,aAAa,CAAC,EAAE,CAAC;MACjBqB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;IAC1B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZJ,KAAK,CAAC,qBAAqB,CAAC;IAC9B;EACF,CAAC;EAED,MAAMK,kBAAkB,GAAG,MAAOC,QAAQ,IAAK;IAC7C,MAAMZ,KAAK,GAAGJ,YAAY,CAACK,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,MAAM,GAAG;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAEJ;MAAM;IAAE,CAAC;IAEpD,IAAI;MACF,MAAMzB,YAAY,CAACqC,QAAQ,EAAEV,MAAM,CAAC;MACpCI,KAAK,CAAC,iBAAiB,CAAC;MACxBC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;IAC1B,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZJ,KAAK,CAAC,uBAAuB,CAAC;IAChC;EACF,CAAC;EAED,oBACE5B,OAAA;IAAAmC,QAAA,gBACEnC,OAAA;MAAQoC,OAAO,EAAEnB,YAAa;MAAAkB,QAAA,EAAC;IAAM;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAC9CxC,OAAA;MAAAmC,QAAA,EAAI;IAAS;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EACjBrC,KAAK,CAACsC,GAAG,CAAE3B,IAAI;MAAA,IAAA4B,iBAAA;MAAA,oBACd1C,OAAA;QAAAmC,QAAA,gBACEnC,OAAA;UAAAmC,QAAA,EAAKrB,IAAI,CAAC6B;QAAK;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eACrBxC,OAAA;UAAAmC,QAAA,GAAG,UAAQ,EAACrB,IAAI,CAAC8B,MAAM;QAAA;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC5BxC,OAAA;UAAAmC,QAAA,EAAI;QAAQ;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,GAAAE,iBAAA,GAChBrC,OAAO,CAACS,IAAI,CAACE,GAAG,CAAC,cAAA0B,iBAAA,uBAAjBA,iBAAA,CAAmBD,GAAG,CAAEI,GAAG,iBAC1B7C,OAAA;UAAAmC,QAAA,gBACEnC,OAAA;YAAAmC,QAAA,GACGU,GAAG,CAACC,QAAQ,EAAC,IAAE,EAACD,GAAG,CAAClB,OAAO;UAAA;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3B,CAAC,EACHK,GAAG,CAACC,QAAQ,KAAK5B,YAAY,CAACK,OAAO,CAAC,UAAU,CAAC,iBAChDvB,OAAA;YAAQoC,OAAO,EAAEA,CAAA,KAAMH,kBAAkB,CAACY,GAAG,CAAC7B,GAAG,CAAE;YAAAmB,QAAA,EAAC;UAEpD;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CACT;QAAA,GAROK,GAAG,CAAC7B,GAAG;UAAAqB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OASZ,CACN,CAAC,eACFxC,OAAA;UACE+C,IAAI,EAAC,MAAM;UACXC,WAAW,EAAC,cAAc;UAC1BC,KAAK,EAAE1C,UAAW;UAClB2C,QAAQ,EAAGC,CAAC,IAAK3C,aAAa,CAAC2C,CAAC,CAACC,MAAM,CAACH,KAAK;QAAE;UAAAZ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChD,CAAC,eACFxC,OAAA;UAAQoC,OAAO,EAAEA,CAAA,KAAMhB,eAAe,CAACN,IAAI,CAACE,GAAG,CAAE;UAAAmB,QAAA,EAAC;QAAU;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA,GAtB7D1B,IAAI,CAACE,GAAG;QAAAqB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAuBb,CAAC;IAAA,CACP,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV;AAACtC,EAAA,CAtFQD,IAAI;EAAA,QAIMH,WAAW;AAAA;AAAAuD,EAAA,GAJrBpD,IAAI;AAwFb,eAAeA,IAAI;AAAC,IAAAoD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}